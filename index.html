<!DOCTYPE html>
<html>
<body>
 <h1>Card PDF Generator</h1>
  <label>
    Front images (PNG):
    <input type="file" id="files" multiple accept="image/png" />
  </label>
  <br/>
  <label>
    Optional back image (PNG):
    <input type="file" id="back" accept="image/png" />
  </label>
  <br/>
  <button id="make">Generate PDF</button>
  <script type="module">
    import init, { generate_pdf } from "./pkg/cardlayouter.js";
    async function run() {
      await init(); // load the .wasm
      const fileInput = document.getElementById("files");
      const backInput = document.getElementById("back");
      document.getElementById("make").onclick = async () => {
        const files = Array.from(fileInput.files);
        const buffers = await Promise.all(files.map(f => f.arrayBuffer()));
        let backBuffer = null;
        if (backInput.files.length > 0) {
          const b = await backInput.files[0].arrayBuffer();
          backBuffer = new Uint8Array(b);
        }
        // call into Rust: give it Vec<Uint8Array> of PNGs
        const pdfBytes = generate_pdf(buffers,backBuffer);
        // turn returned Uint8Array into a blob & download
        const blob = new Blob([pdfBytes], {type: "application/pdf"});
        const url  = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "cards.pdf";
        a.click();
        URL.revokeObjectURL(url);
      };
    }
    run();
  </script>
</body>
</html>
